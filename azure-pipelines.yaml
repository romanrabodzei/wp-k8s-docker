trigger:
- main

variables:
  imageRepository: 'Wordpress'
  tag: '$(Build.BuildId)'
  vmImageName: 'ubuntu-latest'

stages:
- stage: Build
  displayName: Build and push stage
  jobs:
  - job: Build
    displayName: Build
    pool:
      vmImage: $(vmImageName)
    steps:

    - task: AzureCLI@2
      inputs:
        azureSubscription: 'VisualStudio'
        scriptType: 'pscore'
        scriptLocation: 'inlineScript'
        inlineScript: 'docker build -f Dockerfile -t $(containerRegistry).azurecr.io/$(imageRepository):$(tag) .'